# 精神电量漏电检测局 PRD v2

## 1. 项目目标
- 交付一个纯前端、移动端优先的单页 H5 测试应用。
- 用户完成 10 题后得到 A/B/C/D 主类型结果，并可保存结果图进行分享。
- 结果内容定位为娱乐化自我觉察，不提供医疗意义判断。

## 2. 技术范围
- 技术栈：原生 `HTML/CSS/JavaScript`。
- 运行方式：静态文件可直接部署到任意静态托管环境。
- 外部库：`html2canvas`（用于结果区域截图导出）。
- 布局约束：容器最大宽度 `max-width: 28rem`（约 `max-w-md`）。

## 3. 数据契约
### 3.1 题目数据 `questions`
- 共 10 题。
- 每题结构：
  - `id: number`（唯一）
  - `text: string`
  - `options: Array<{ text: string; type: 'A'|'B'|'C'|'D' }>`（固定 4 项）

### 3.2 结果数据 `resultProfiles`
- 键值固定为 `A/B/C/D`。
- 每个类型必填字段：
  - `title`
  - `subtitle`
  - `description`
  - `comfort`
  - `ctaText`

## 4. 页面流与状态机
1. Landing
   - 展示标题、说明、`开始扫描`按钮。
2. Quiz
   - 展示 `当前题号/总题数` 与进度条。
   - 点击选项后立即高亮反馈并锁定当前题，防止重复计分。
   - 300ms 后自动切换下一题。
3. Loading
   - 第 10 题后进入过渡态，显示“正在解析脑电波数据...”动画约 2 秒。
4. Result
   - 展示主类型文案、四类型得分、免责声明、保存与领取按钮。
   - 弹窗显示二维码占位图及行动引导文案。

## 5. 计分规则
- 初始化分数：`{ A:0, B:0, C:0, D:0 }`。
- 每题仅记首次有效点击。
- 用户每次作答将所选 `type` 计数 +1，并记录本次命中类型为 `lastHitType`。
- 主类型计算：
  1. 取最高分集合。
  2. 若唯一最高分，直接返回该类型。
  3. 若并列最高分，采用 **最后命中优先**（`lastHitType`）作为主类型。

## 6. 保存分享规则
- 按钮文案：`长按保存检测报告`。
- 点击后对结果区域执行截图导出：
  - 成功：尝试自动下载 PNG，并展示“可长按预览图保存”的提示。
  - 失败：展示兜底提示“请长按截图保存，或长按预览图保存”。
- 保持双通道兜底：`自动下载` + `长按保存提示`。

## 7. 合规与文案口径
- 结果页固定弱提示：`结果仅供参考`。
- 文案延续娱乐风格，避免表达成医疗诊断结论。

## 8. 异常与边界处理
- 连点同题：只采纳第一次点击，其余点击忽略。
- 重复点击保存按钮：生成中状态下忽略重复触发。
- 弹窗交互：支持点击遮罩关闭、点击关闭按钮关闭、`Esc` 关闭。
- 刷新页面：默认回到 Landing（不做答题进度持久化）。

## 9. 验收标准
1. 用户可完整完成 10 题并进入结果页。
2. 进度显示正确（如 `1/10` 到 `10/10`）。
3. 每题点击后 300ms 左右切换，且不会重复计分。
4. Loading 约 2 秒后进入结果。
5. 并列最高分时结果与“最后命中优先”一致。
6. 结果页显示四类分数与主类型文案。
7. 保存成功有下载行为与预览图提示；失败有明确兜底提示。
8. 二维码弹窗可打开与关闭。
